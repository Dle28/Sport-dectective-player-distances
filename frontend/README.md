# Sport Detective - Player Tracking Visualization

A Next.js dashboard for visualizing soccer/football player tracking data generated by the Sport Detective Python backend.

## Features

- **Live Pitch View**: SVG-based soccer pitch with real-time player positions
- **Player Tracking**: Visual trails showing player movement history
- **Timeline Controls**: Play/pause, scrub through frames, time display
- **Distance Statistics**: Sortable table showing total, sprint, run, and walk distances
- **Team Visualization**: Color-coded players by team assignment
- **Interactive Selection**: Click players to highlight and view individual trails

## Tech Stack

- **Framework**: Next.js 14 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **State Management**: Zustand
- **Visualization**: D3.js, SVG

## Prerequisites

- Node.js 18+
- pnpm (recommended) or npm
- Python backend with generated tracking data

## Installation

```bash
# Navigate to frontend directory
cd frontend

# Install dependencies
pnpm install
# or
npm install
```

## Data Structure

The frontend expects data files in the parent project's output directory:

```
Sport-dectective-player-distances/
├── data/
│   └── tracks_xy/
│       └── 5ph_demo_tracks.json
├── outputs/
│   └── run_data/
│       └── stats/
│           └── player_distances.json
└── frontend/
    └── ...
```

### Tracks Data Format (`5ph_demo_tracks.json`)

```json
{
  "fps": 25.0,
  "video_path": "data/5ph.mp4",
  "tracks": {
    "1": [
      {
        "frame_index": 0,
        "player_id": 1,
        "x": 10.5,
        "y": 8.2,
        "visible": true
      }
    ]
  }
}
```

### Distance Data Format (`player_distances.json`)

```json
[
  {
    "player_id": 1,
    "team": "Team A",
    "total_distance": 5234.5,
    "sprint_distance": 1023.4,
    "run_distance": 2456.7,
    "walk_distance": 1754.4,
    "possession_seconds": 45.2
  }
]
```

## Development

```bash
# Start development server
pnpm dev

# Open browser
http://localhost:3000
```

## Build

```bash
# Production build
pnpm build

# Start production server
pnpm start
```

## Usage

1. **Generate tracking data**: Run the Python backend to process a video and generate tracking JSON files
2. **Start the frontend**: Run `pnpm dev` in the frontend directory
3. **Select a player**: Use the dropdown or click on a player in the pitch view
4. **Control playback**: Use play/pause and timeline slider
5. **View statistics**: Check the distance table for detailed metrics
6. **Toggle visualization**: Enable/disable trails and heatmap overlays

## API Routes

- `GET /api/tracks` - Returns player tracking data with pitch coordinates
- `GET /api/distances` - Returns player distance statistics

Both routes include fallback sample data if files are not found.

## Project Structure

```
frontend/
├── app/
│   ├── api/
│   │   ├── distances/route.ts
│   │   └── tracks/route.ts
│   ├── globals.css
│   ├── layout.tsx
│   └── page.tsx
├── components/
│   ├── DistanceTable.tsx
│   ├── HeatmapToggle.tsx
│   ├── PitchCanvas.tsx
│   └── TrackControls.tsx
├── lib/
│   ├── store.ts
│   ├── types.ts
│   └── utils.ts
└── public/
```

## Customization

### Pitch Dimensions

Edit `PITCH_WIDTH` and `PITCH_HEIGHT` constants in `components/PitchCanvas.tsx`:

```typescript
const PITCH_WIDTH = 105 // meters
const PITCH_HEIGHT = 68 // meters
```

### Player Colors

Modify `getPlayerColor()` in `lib/utils.ts` for custom team colors.

### Data Paths

Update API route paths in `app/api/tracks/route.ts` and `app/api/distances/route.ts` if your data structure differs.

## Troubleshooting

### No data showing

- Ensure Python backend has generated tracking files
- Check file paths in API routes match your directory structure
- Verify data format matches expected JSON schema

### Players not rendering

- Check console for errors
- Verify coordinate ranges are within pitch bounds (0-105m x, 0-68m y)
- Ensure `visible: true` in track data

### Timeline not updating

- Check `fps` value in tracks data
- Verify `frame_index` values are sequential

## License

MIT
